import{_ as U}from"./D4udR0JH.js";import{_ as q}from"./Dq3GPOqN.js";import{U as $,Z as R,j as v,o as s,c as u,u as T,x as C,a,t as c,W as t,aM as E,n as H,f as k,b as g,F as V,r as N,d as A,a4 as W,aa as Z,ap as G,a6 as J,_ as Q,V as X,bt as tt,i as P,Y as F,k as et,a3 as st,aw as at}from"./DSD2pUNw.js";import{T as ot,E as M,a as z}from"./2bM3XT7z.js";import{_ as nt}from"./CLCdp-T4.js";import{_ as ct}from"./CKIiqM3i.js";import{u as it}from"./oMPCwqzb.js";import{u as rt}from"./CygSoWUo.js";import{_ as lt}from"./DKu6f-4p.js";import{u as pt}from"./B06lemC6.js";import"./vTJyTPoi.js";import"./DUXdqV41.js";import"./Zs2GqXH5.js";import"./BOAzHGzj.js";import"./DW4oqbe0.js";import"./56Y_7FHu.js";import"./SOohJPuW.js";import"./D8aEg3BZ.js";import"./R1YRABMb.js";const ut={class:"ticket-header"},_t={class:"ticket-header-date"},mt={class:"tw-text-base tw-font-bold tw-me-2"},dt={class:"tw-text-text-brand tw-text-base"},kt={class:"ticket-header-status"},gt=$({__name:"SingleTicketHeader",props:{ticketId:{},ticket:{},onCloseTicket:{type:Function}},setup(d){const o=d,{t:l}=R(),e=v(()=>ot[o.ticket.status]),_=v(()=>e.value.statusKey),m=v(()=>"status-"+e.value.name);return(p,h)=>{const B=U,I=q;return s(),u(V,null,[T(B,{"title-key":"ticket_capitalize","icon-name":"contact-us"},{additionalTitle:C(()=>[a("span",null,"#"+c(p.ticketId),1)]),_:1}),a("div",ut,[a("div",_t,[a("span",mt,c(t(l)("date_created"))+":",1),a("span",dt,c(t(E)(p.ticket.created_at)),1)]),a("div",kt,[a("span",null,c(t(l)("status"))+":",1),a("div",{class:H(["tw-p-1 tw-rounded fg-main-12-fat tw-text-text-dark",t(m)])},c(t(l)(t(_))),3)]),p.ticket.status===t(M).Opened||p.ticket.status===t(M).InProgress?(s(),k(I,{key:0,"label-key":"close_ticket","color-type":"outline",class:"ticket-header-button",onClick:h[0]||(h[0]=f=>p.onCloseTicket(p.ticketId))})):g("",!0)])],64)}}}),ht={class:"messages-list"},ft={class:"tw-flex tw-justify-between fg-main-14-fat"},wt={key:0},yt={key:1},vt={class:"tw-text-text-tertiary tw-text-right fg-main-14-thin"},Tt={class:"tw-text-text-secondary fg-main-14-thin tw-mt-2"},$t={key:0,class:"tw-flex tw-flex-wrap tw-gap-2 tw-mt-2"},St=["href"],bt=["src"],Ct=$({__name:"SingleTicketMessagesList",props:{messages:{}},setup(d){return(o,l)=>(s(),u("div",ht,[(s(!0),u(V,null,N(o.messages,e=>(s(),u("div",{key:e.id,class:H(["message-wrapper",{"message-wrapper--support":e.author===t(z).SupportManager}])},[a("div",ft,[e.author===t(z).Me?(s(),u("span",wt,c(o.$t("me")),1)):(s(),u("span",yt,c(o.$t("support_manager")),1)),a("div",vt,c(t(E)(e.created_at)),1)]),a("div",Tt,c(e.content),1),e.attachments.length?(s(),u("div",$t,[(s(!0),u(V,null,N(e.attachments,(_,m)=>(s(),u("a",{key:m,href:_.url,target:"_blank",class:"attachment-img"},[a("img",{src:_.url,alt:"attachment img"},null,8,bt),a("span",null,c(_.name),1)],8,St))),128))])):g("",!0)],2))),128)),A(o.$slots,"pagination")]))}}),Mt={key:0,class:"ticket-thank"},Bt={class:"ticket-thank-title"},It={class:"ticket-thank-desc"},Vt={class:"ticket-thank-desc"},xt=$({__name:"TicketThankYouBlock",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(d,{emit:o}){const l=d,e=o,_=()=>e("update:modelValue",!1);return(m,p)=>l.modelValue?(s(),u("div",Mt,[T(t(Z),{class:"ticket-thank-btn","color-type":"outlined",onClick:_},{default:C(()=>[T(t(W),{name:"close",size:12})]),_:1}),a("h2",Bt,c(m.$t("thank_you_for")),1),a("p",It,c(m.$t("we_appreciate")),1),a("p",Vt,c(m.$t("while_we_do_our_best")),1)])):g("",!0)}}),Nt=$({__name:"SingleTicketMain",props:{ticketId:{},ticket:{},onCloseTicket:{type:Function}},setup(d){const{show:o}=G(),l=J(),e=Q(),_=X(),m=d,{t:p}=R(),h=tt(),{closeTicket:B,fetchSingleTicket:I}=h,f=P(!!l.query.new),i=P({page:1,total:0,next_page:null,per_page:10,prev_page:null,total_pages:0}),{setBreadcrumbs:L}=it();L([{label:p("support"),path:F.contact_us},{label:`${p("ticket_capitalize")} #${l.params.id.toString()}`}]);const w=v(()=>h.ticket),Y=v(()=>{var n;const r=(n=w.value)==null?void 0:n.status;return r===M.Opened||r===M.InProgress}),j=({page:r,perPage:n})=>{i.value.per_page!==n?i.value.page=1:i.value.page=r,i.value.per_page=n,x()},x=async()=>{try{const r=await I(m.ticketId,{page:i.value.page,per_page:i.value.per_page}),{per_page:n,current_page:y,total:S}=r.messages;i.value={per_page:n,total:S,page:y,next_page:y+1,prev_page:y-1,total_pages:Math.ceil(S/n)}}catch(r){const{msg:n}=r;o({message:n,type:"error"}),e.push(_({path:F.contact_us}))}};return et(()=>{x()}),rt({title:()=>w.value.title??"Tickets item"}),(r,n)=>{const y=gt,S=Ct,D=xt,K=nt,O=ct;return s(),k(O,{loading:t(w)===null},{default:C(()=>[T(y,{ticket:t(w),"on-close-ticket":t(B),"ticket-id":r.ticketId},null,8,["ticket","on-close-ticket","ticket-id"]),T(S,{messages:t(w).messages.data},{pagination:C(()=>{var b;return[((b=t(i))==null?void 0:b.total_pages)>1?(s(),k(lt,{key:0,class:"tickets-pagination","current-page":t(i).page,total:t(i).total,pages:t(i).total_pages,"per-page":10,onChange:j},null,8,["current-page","total","pages"])):g("",!0)]}),_:1},8,["messages"]),t(f)?(s(),k(D,{key:0,modelValue:t(f),"onUpdate:modelValue":n[0]||(n[0]=b=>st(f)?f.value=b:null)},null,8,["modelValue"])):g("",!0),t(Y)?(s(),k(K,{key:1,"ticket-id":r.ticketId},null,8,["ticket-id"])):g("",!0)]),_:1},8,["loading"])}}}),Qt=$({__name:"[id]",setup(d){return pt(),(o,l)=>{const e=Nt;return s(),k(e,{"ticket-id":(o._.provides[at]||o.$route).params.id},null,8,["ticket-id"])}}});export{Qt as default};
