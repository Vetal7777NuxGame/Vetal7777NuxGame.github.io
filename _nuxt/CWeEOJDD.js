import{_ as ft}from"./D4udR0JH.js";import{b as gt,_ as yt,C as ot,c as wt,M as bt}from"./BcNY68dZ.js";import{_ as W}from"./Dq3GPOqN.js";import{u as vt,f as ct}from"./BLR1aNLP.js";import{bh as ut,U as X,Z as Y,a1 as st,$ as Z,a0 as R,j as F,o as u,c as V,a as e,t as b,W as t,b as $,f as M,ah as dt,ai as pt,a5 as K,u as d,x as O,T as nt,br as at,ab as mt,i as w,M as $t,K as Ct,bq as _t,aJ as St,ac as xt,ae as A,k as Mt,a4 as Nt,F as kt,n as Ot,z as It}from"./DSD2pUNw.js";import{_ as Tt}from"./R1YRABMb.js";import{_ as Vt}from"./rnzwH3QY.js";import{_ as lt}from"./CrE1ES4d.js";import{u as Lt}from"./CygSoWUo.js";import{u as rt}from"./tIRvP6xh.js";import{u as Pt}from"./DRPBFnCi.js";import{_ as Bt}from"./DUXdqV41.js";import{c as J,_ as Et}from"./Dd1fHdsP.js";import{_ as Dt}from"./SOohJPuW.js";import{_ as Ut}from"./vTJyTPoi.js";import{a as Rt}from"./Zs2GqXH5.js";import"./xL4uUKpb.js";import"./D8aEg3BZ.js";import"./DaXGcVam.js";import"./CTKbW84e.js";import"./56Y_7FHu.js";import"./CKIiqM3i.js";import"./BOAzHGzj.js";const qt=ut("/img/GEM.png"),zt=i=>(dt("data-v-4e4f4ce6"),i=i(),pt(),i),At={class:"shop-card"},Ft={class:"shop-card-img-wrapper"},Ht=["src","alt"],Gt={class:"shop-card-info"},jt={class:"tw-flex tw-items-center tw-justify-between tw-mt-auto"},Wt={class:"tw-flex tw-items-center"},Kt=zt(()=>e("img",{src:qt,alt:"gem"},null,-1)),Jt={class:"tw-flex tw-flex-col tw-ml-2"},Xt={key:0,class:"shop-card-price"},Yt={class:"fg-title-16-bold"},Zt=X({__name:"CardShop",props:{product:{}},emits:["openModal"],setup(i,{emit:C}){const{platformCommasFormat:S}=vt(),p=["0f0b84f4-bf49-417e-bf4d-4fad0cbcb289","8213223e-e1e4-4e0b-8046-03b7a6b1ede7"],x=C,L=i,{t:I}=Y(),T=st(),m=Z(),{isLoggedIn:P}=R(T),{isHideSingInBtn:B,isHideRegistrationBtn:E}=R(m),N=F(()=>P.value?I("buy_now"):I("join_now")),_=()=>{x("openModal",L.product)};return(h,k)=>{const c=W;return u(),V("div",At,[e("div",Ft,[e("img",{src:h.product.banner,alt:`shop-card ${h.product.name}`,class:"img",onClick:_},null,8,Ht)]),e("div",Gt,[e("h3",{class:"shop-card-title fg-text-14-fat",onClick:_},b(h.product.name),1),e("div",jt,[e("div",Wt,[Kt,e("p",Jt,[h.product.discount?(u(),V("span",Xt,b(t(S)(p,h.product.price,".",!0)),1)):$("",!0),e("span",Yt,b(t(S)(p,h.product.total,".",!0)),1)])]),t(B)&&t(E)?$("",!0):(u(),M(c,{key:0,"label-key":t(N),onClick:_},null,8,["label-key"]))])])])}}}),Qt=K(Zt,[["__scopeId","data-v-4e4f4ce6"]]),te=ut("/img/successful.png"),ee={},oe=i=>(dt("data-v-9a71e62f"),i=i(),pt(),i),se={class:"tw-font-bold"},ne={class:"success-block"},ae=oe(()=>e("img",{src:te,alt:"successful",class:"tw-mb-6 tw-mt-4"},null,-1)),le={class:"tw-text-lg tw-font-bold"};function ce(i,C){const S=W,p=lt;return u(),M(nt,{to:"#globalModal"},[d(p,{class:"buy-modal success","fullscreen-mode":"","modal-max-width":"512px",onClose:C[1]||(C[1]=x=>i.$emit("close"))},{title:O(()=>[e("h2",se,b(i.$t("success")),1)]),content:O(()=>[e("div",ne,[ae,e("p",le,b(i.$t("purchase_was_successful")),1),d(S,{"label-key":i.$t("continue_shopping"),"color-type":"primary",class:"tw-mt-6 tw-w-full",onClick:C[0]||(C[0]=x=>i.$emit("close"))},null,8,["label-key"])])]),_:1})])}const re=K(ee,[["render",ce],["__scopeId","data-v-9a71e62f"]]),it=""+new URL("gem.Dvq6UNL7.svg",import.meta.url).href,ie={class:"shop-modal-img-wrapper"},ue=["src","alt"],de={class:"shop-modal-info"},pe={class:"shop-modal-title fg-title-20-thin"},me=["innerHTML"],_e={key:0,class:"shop-modal-prices"},he={class:"shop-modal-prices_text fg-text-12-thin"},fe={class:"shop-modal-tiers fg-text-12-fat"},ge={class:"tw-text-center tw-text-text-tertiary tw-font-bold"},ye={class:"tw-flex tw-items-center tw-text-base tw-font-bold mobileLarge:tw-text-sm"},we=["src"],be={class:"ng-modal-footer"},ve={class:"tw-flex tw-items-center"},$e=["src"],Ce={class:"tw-flex tw-flex-col"},Se={key:0,class:"shop-modal-price fg-text-12-thin tw-line-through tw-text-text-tertiary"},xe={class:"tw-text-xl tw-font-bold tw-leading-6"},Me=4,Ne=X({__name:"ProductModal",props:{id:{}},emits:["close","open-buy-modal","success"],setup(i,{emit:C}){const S=i,p=C,x=st(),L=at(),I=mt(),T=Z(),{t:m}=Y(),{shiftOpenedModals:P}=T,{fetchProduct:B,submitOrder:E}=L,{getTiers:N,fetchSettings:_,fetchData:h}=I,{isLoggedIn:k}=R(x),c=w(null),g=w([]),l=F(()=>k.value?m("buy_now"):m("join_now")),v=F(()=>{var y,a;return((y=c.value)==null?void 0:y.is_bonus)||((a=c.value)==null?void 0:a.type)===Me}),D=F(()=>{var y;return Number(N.points??0)<Number((y=c.value)==null?void 0:y.price)}),H=async()=>{const y=await B(S.id);c.value=y.product,g.value=y.prices},U=()=>{P(),p("close")},G=()=>{v.value?q():(p("open-buy-modal",c.value),U())},q=async()=>{try{await E({id:S.id}),_(),h(),U(),p("success")}catch(y){const{error_code:a,latestDate:n=null}=y;a===_t.BONUS_CANNOT_BE_CLOSED&&n&&p("close")}};return $t(()=>{H()}),(y,a)=>{const n=W,s=lt;return u(),M(nt,{to:"#globalModal"},[t(c)?(u(),M(s,{key:0,"modal-max-width":"512px","without-bg":"","fullscreen-mode":"",class:"shop-modal",onClose:a[0]||(a[0]=o=>p("close"))},{title:O(()=>[e("div",ie,[e("img",{src:t(c).banner,alt:`shop-modal ${t(c).name}`,class:"img"},null,8,ue)])]),content:O(()=>[e("div",de,[e("h3",pe,b(t(c).name),1),e("p",{class:"shop-modal-desc fg-text-14-thin",innerHTML:t(c).description},null,8,me),t(g).length?(u(),V("div",_e,[e("p",he,b(t(m)("play_more")),1),e("div",fe,[e("p",ge,b(t(g)[0].tier_name),1),e("p",ye,[e("img",{src:t(it),alt:"gem",width:"16",height:"16",class:"tw-mr-1"},null,8,we),Ct(" "+b(t(g)[0].total),1)])])])):$("",!0)]),e("div",be,[e("div",ve,[e("img",{src:t(it),alt:"gem",width:"24",height:"24",class:"tw-mr-1"},null,8,$e),e("p",Ce,[t(c).discount?(u(),V("span",Se,b(t(ct)(t(c).price)),1)):$("",!0),e("span",xe,b(t(ct)(t(c).total)),1)])]),d(n,{"is-disabled":t(D),"label-key":t(l),class:"submit-btn",onClick:G},null,8,["is-disabled","label-key"])])]),_:1})):$("",!0)])}}}),ke=K(Ne,[["__scopeId","data-v-8bd7ab96"]]),Oe={class:"tw-font-bold"},Ie={class:"tw-flex tw-flex-col tw-gap-4 tw-p-4 tw-h-full"},Te={class:"tw-flex tw-items-center slot-option"},Ve={class:"tw-flex"},Le={class:"tw-ml-2"},Pe={class:"country-label fg-text-14-thin"},Be={class:"country-name fg-text-14-thin"},Ee={class:"tw-flex tw-items-center"},De={class:"tw-ml-2"},Ue={class:"country-name fg-text-14-thin"},Re={class:"tw-flex tw-justify-center tw-mt-auto"},qe=X({__name:"ProductBuyModal",props:{product:{}},emits:["close","success"],setup(i,{emit:C}){const{product:S}=i,p=C,x=mt(),L=Z(),I=at(),T=St(),{t:m}=Y(),{submitOrder:P}=I,{fetchProfile:B}=T,{fetchSettings:E,fetchData:N}=x,{handleSubmit:_}=Rt({validationSchema:xt({full_name:A().required(),country:A().required(),phone:A().min(6).max(16).required(),city:A().required(),street:A().required(),zip_code:A().required()})}),{getCountryCode:h}=R(L),{getProfileInfo:k}=R(T),c=new Map(J.map(a=>[a.iso2,a])),g=w(null),l=w({full_name:"",country:"",phone:"",city:"",street:"",zip_code:""}),v=w(""),D=w({}),H=F(()=>S.is_bonus||S.type===4),U=F(()=>H.value?m("product_with_out_order_heading"):m("shipping_address")),G=()=>{var a,n,s;if((n=(a=k.value)==null?void 0:a.country_code)!=null&&n.length)J.forEach(o=>{o.iso2===k.value.country_code&&(v.value=o.phone_code,l.value.country=o.iso2,D.value=o)});else{const o=((s=h.value)==null?void 0:s.toLowerCase())??"",f=c.get(o)??J[0];v.value=f.phone_code,l.value.country=f.iso2,D.value=f}},q=_(async()=>{var a;g.value=null;try{await P({...l.value,id:S.id}),E(),N(),p("close"),p("success")}catch(n){const{error_code:s,latestDate:o=null}=n,f=(a=n==null?void 0:n.errors)==null?void 0:a.zip_code;f&&(g.value={msg:f[0]}),s===_t.BONUS_CANNOT_BE_CLOSED&&o&&p("close")}}),y=a=>{l.value.phone=`${a.phoneCode}${a.phone}`};return Mt(async()=>{try{await B()}catch(a){console.error(a)}G()}),(a,n)=>{const s=Bt,o=Et,f=Nt,j=Dt,Q=Ut,tt=W,et=lt;return u(),M(nt,{to:"#globalModal"},[d(et,{class:"buy-modal","fullscreen-mode":"","modal-max-width":"512px",onClose:n[6]||(n[6]=r=>p("close"))},{title:O(()=>[e("h2",Oe,b(t(U)),1)]),content:O(()=>[e("form",Ie,[d(s,{modelValue:t(l).full_name,"onUpdate:modelValue":n[0]||(n[0]=r=>t(l).full_name=r),modelModifiers:{trim:!0},"placeholder-text":t(m)("full_name"),"is-required":!0,"input-name":"full_name"},null,8,["modelValue","placeholder-text"]),d(o,{modelValue:t(l).phone,"onUpdate:modelValue":n[1]||(n[1]=r=>t(l).phone=r),class:"settings-input settings-phone","default-code":t(v),"is-required":!0,"input-name":"phone",onChange:y},null,8,["modelValue","default-code"]),d(j,{modelValue:t(l).country,"onUpdate:modelValue":n[2]||(n[2]=r=>t(l).country=r),"default-option":t(D),"additional-label":a.$t("country"),"displayed-option":"name",placeholder:a.$t("country"),"returned-option":"iso2","item-list":t(J),"is-required":!0,"input-name":"country","is-search-icon":"","is-searchable":""},{"selected-option":O(({props:r})=>[e("div",Te,[d(f,{"is-init-color":!0,name:r.iso2,size:24,folder:"flags",class:"country-flag"},null,8,["name"]),e("div",Ve,[r.iso2?$("",!0):(u(),M(f,{key:0,color:t(gt)["fg-tertiary"],name:"country",size:20},null,8,["color"])),e("div",Le,[e("p",Pe,b(t(m)("country")),1),e("p",Be,b(r.name),1)])])])]),option:O(({props:r})=>[e("div",Ee,[d(f,{"is-init-color":!0,name:r.iso2,size:24,folder:"flags",class:"country-flag"},null,8,["name"]),e("div",De,[e("p",Ue,b(r.name),1)])])]),_:1},8,["modelValue","default-option","additional-label","placeholder","item-list"]),d(s,{modelValue:t(l).city,"onUpdate:modelValue":n[3]||(n[3]=r=>t(l).city=r),modelModifiers:{trim:!0},"placeholder-text":t(m)("enter_city"),"is-required":!0,"input-name":"city"},null,8,["modelValue","placeholder-text"]),d(s,{modelValue:t(l).street,"onUpdate:modelValue":n[4]||(n[4]=r=>t(l).street=r),modelModifiers:{trim:!0},"placeholder-text":t(m)("enter_details"),"is-required":!0,"input-name":"street"},null,8,["modelValue","placeholder-text"]),d(s,{modelValue:t(l).zip_code,"onUpdate:modelValue":n[5]||(n[5]=r=>t(l).zip_code=r),modelModifiers:{trim:!0},"placeholder-text":t(m)("enter_zip_code"),"is-required":!0,"input-name":"zip_code"},null,8,["modelValue","placeholder-text"]),t(g)?(u(),M(Q,{key:0,error:t(g)},null,8,["error"])):$("",!0),e("div",Re,[d(tt,{"label-key":t(m)("submit"),"color-type":"primary",class:"tw-w-full",onClick:t(q)},null,8,["label-key","onClick"])])])]),_:1})])}}}),ze=K(qe,[["__scopeId","data-v-1bb3a100"]]),Ae={class:"shop"},Fe={key:0,class:"tw-flex tw-flex-col tw-gap-2 tw-mt-4"},He={key:0,class:"shop-pagination"},Ge=12,je=X({__name:"shop",setup(i){const C=st(),S=at(),p=Z(),{t:x}=Y(),{setAuthModal:L}=C,{fetchProducts:I,fetchFilters:T}=S,{isLoggedIn:m}=R(C),{isChatOpened:P,isMenuOpened:B}=R(p),E=w(1),N=w(!1),_=w({order:"order",order_dir:"asc",category_ids:[],search:"",limit:Ge}),h=w([]),k=w(null),c=w([]),g=w(null),l=w(null),v=w(null),D=async()=>{const s={..._.value,"category_ids[]":[..._.value.category_ids].filter(o=>o!==0)};delete s.category_ids;try{const o=await I(s);c.value=o.products,v.value=o.pagination}catch(o){console.error("shopGetDataCallAction pages/shop.vue",o)}},H=async()=>{try{g.value=await T(),G()}catch(s){console.error("shopFiltersCallAction pages/shop.vue",s)}},U=()=>g.value.order_fields.map(s=>({label:x(s.label),data:s.data})),G=()=>{var s,o;if(h.value=[{target:"search",componentName:ot.SEARCH_INPUT,props:{classes:"tw-col-span-4",modelValue:"",placeholderText:x("search"),isRequired:!0},mobile:{class:"tw-col-span-6"},leftIcon:{name:"search",size:20}}],(s=g.value)!=null&&s.categories.length){const f=[...g.value.categories];h.value.push({target:"category",componentName:ot.MULTI_SELECTOR,props:{modelValue:[0],itemList:f,displayedOption:"name",returnedOption:"id",trackOption:"id",isSearchable:!0,isOptionSearchable:!0,isCloseOnSelected:!1,classList:"categories-list"},mobile:{redirect:!0},counted:{titleKey:"category"},optionsType:wt.TOGGLER_CHECKBOX})}(o=g.value)!=null&&o.order_fields.length&&h.value.push({target:"orders",componentName:ot.SINGLE_SELECTOR,props:{modelValue:"",displayedOption:"label",returnedOption:"data",additionalLabel:`${x("sort_by")}:`,defaultOption:U()[0],itemList:U()},mobile:{redirect:!0}})},q=s=>{const o=s.orders,f=s.search?String(s.search):"",j=s.category;_.value={..._.value,category_ids:j,search:f,...o}},y=s=>{if(m.value)k.value=s.id;else{const{nameModal:o}=Pt();o&&L(o)}},a=s=>{l.value=s},n=()=>{const s=Number(E.value)+1,o=_.value.limit*s;_.value={..._.value,limit:o}};return rt("getShopData",async()=>await D(),{watch:[m,_]}),rt("shopFiltersCallAction",async()=>await H()),Lt({title:x("shop")}),(s,o)=>{const f=ft,j=yt,Q=Qt,tt=Tt,et=W,r=Vt,ht=re;return u(),V("div",Ae,[d(f,{class:"tw-font-bold","icon-name":"shop","title-key":"shop"}),t(h).length?(u(),V("div",Fe,[d(j,{list:t(h),"mobile-settings":{type:("MobileVersionType"in s?s.MobileVersionType:t(bt)).ACCORDION,style:{accordionContainerClass:"shop-filter-accordion"}},"order-settings":{gridCols:6},onChange:q,onInput:q},null,8,["list","mobile-settings"])])):$("",!0),t(c).length?(u(),V(kt,{key:1},[e("div",{class:Ot([{"shop-list-chat":t(P),"shop-list-menu":t(B)},"shop-list"])},[d(tt,{container:!1,list:t(c),"key-name":"shop-list"},{item:O(({item:z})=>[d(Q,{product:z,onOpenModal:y},null,8,["product"])]),_:1},8,["list"])],2),t(v)&&t(c).length?(u(),V("div",He,[t(v).next_page?(u(),M(r,{key:0,item:{total:t(v).total,total_pages:t(v).total,page:t(v).per_page},"item-count":t(v).count},It({_:2},[t(v).next_page?{name:"action",fn:O(()=>[d(et,{"color-type":"outline","label-key":"show_more",onClick:n})]),key:"0"}:void 0]),1032,["item","item-count"])):$("",!0)])):$("",!0)],64)):$("",!0),t(k)?(u(),M(ke,{key:2,id:t(k),onClose:o[0]||(o[0]=z=>k.value=null),onSuccess:o[1]||(o[1]=z=>N.value=!0),onOpenBuyModal:a},null,8,["id"])):$("",!0),t(l)?(u(),M(ze,{key:3,product:t(l),onClose:o[2]||(o[2]=z=>l.value=null),onSuccess:o[3]||(o[3]=z=>N.value=!0)},null,8,["product"])):$("",!0),t(N)?(u(),M(ht,{key:4,onClose:o[4]||(o[4]=z=>N.value=!1)})):$("",!0)])}}}),go=K(je,[["__scopeId","data-v-53bbbc86"]]);export{go as default};
