import{_ as ns}from"./iGJpO4hG.js";import{_ as as}from"./DpuOAysh.js";import{U as ls,_ as us,ab as is,a1 as cs,$ as rs,V as Bs,ax as ds,ak as ms,Z as bs,a0 as V,i as A,j as u,p as fs,o as l,c as T,W as t,f as r,n as m,b as i,t as ps,F as _s,aO as vs,aP as ws,a8 as v,bq as Ss,ay as Cs,a9 as Ms}from"./GLBH15dL.js";import{u as As}from"./BvI9bkuF.js";import{d as ys}from"./DOMz106x.js";const gs={key:6,class:"tw-text-sm tw-text-text-error-primary tw-mt-2"},Is=ls({__name:"BonusActions",props:{bonus:{},showBonusInfo:{type:Boolean,default:!0},isButtonsSmall:{type:Boolean,default:!1},error:{default:null}},setup(D){const e=D,R=us(),L=is(),b=cs(),y=rs(),U=Bs(),g=ds(),n=ms(),{t:c}=bs(),{$emitter:f}=Ms(),{actualizeUserData:O}=L,{showActivateModal:x}=n,{shiftOpenedModals:P,closeAllModals:$}=y,{isLoggedIn:k}=V(b),{isMultiBalance:W,isHideSingInBtn:F,isHideRegistrationBtn:j}=V(y),w=A(!1),S=A(null),B=A(null),z=u(()=>{var s;return((s=e.bonus)==null?void 0:s.allow_close)&&b.isLoggedIn}),C=u(()=>{var s;return((s=e.bonus)==null?void 0:s.activated)===!0}),H=u(()=>{var s,o;return((o=(s=e.bonus)==null?void 0:s.actions)==null?void 0:o.includes("deposit"))&&b.isLoggedIn&&C.value}),q=u(()=>{var s,o;return((o=(s=e.bonus)==null?void 0:s.actions)==null?void 0:o.includes("make_spins"))&&C.value}),p=u(()=>{var d,_,N,I;const s=!((d=e.bonus)!=null&&d.activated),o=ys().isAfter((N=(_=e.bonus)==null?void 0:_.extra)==null?void 0:N.expiration_after),a=((I=e.bonus)==null?void 0:I.status)===4;return s&&(o||a)}),Z=u(()=>{var s;return(s=e.bonus)==null?void 0:s.not_for_activation}),G=u(()=>!p.value&&!Z.value&&!C.value&&k.value),J=u(()=>!k.value&&!p.value&&!(F.value&&j.value)),K=()=>{W.value||e.bonus.actions.includes(vs.PROMO_CODE)?(Q(),x(e.bonus,ws.BONUSES)):X()},Q=()=>{f.on(v.BONUS_ACTIVATED,h),f.on(v.CLOSE_BONUS_MODAL,E)},E=()=>{f.off(v.BONUS_ACTIVATED),f.off(v.CLOSE_BONUS_MODAL)},h=async()=>{await n.getBonusById(e.bonus.id),n.setActiveBonus(),n.setVisibleBonusModal(!1),await O(),E(),$()},X=async()=>{try{B.value=null,await n.postActivateBonus(e.bonus.id,void 0),h()}catch(s){const o=s;B.value=(o==null?void 0:o.msg)||o.message,console.log("activateBonus BonusActions",s)}},Y=async()=>{try{B.value=null,await n.postCancelBonus(),await n.getBonusById(e.bonus.id),n.setActiveBonus(),M(),n.setVisibleBonusModal(!1),await O()}catch(s){const{msg:o,message:a,error_code:d}=s;d===Ss.BONUS_CANNOT_BE_CLOSED&&M(),B.value=o||a,console.log("cancelBonus BonusActions",s)}},ss=()=>{var s;n.setVisibleBonusModal(!1),n.setCurrentBonusId(null),R.push(U({name:"games-id",params:{id:(s=e.bonus)==null?void 0:s.extra.game_id}}))},os=()=>{n.setVisibleBonusModal(!1),n.setCurrentBonusId(null),g.setWalletModalTab(Cs.deposit),g.setWalletModal(!0)},ts=()=>{n.setVisibleBonusModal(!1),n.setCurrentBonusId(null);const{nameModal:s}=As();s&&b.setAuthModal(s)},es=s=>{n.setCurrentBonusId(s),n.setVisibleBonusModal(!0)},M=()=>{w.value=!1,P()};return fs(()=>e.error,()=>{S.value=e.error}),(s,o)=>{const a=ns,d=as;return l(),T(_s,null,[t(H)&&!t(p)?(l(),r(a,{key:0,class:m({"tw-w-full":!s.isButtonsSmall}),label:t(c)("bonus_deposit"),onClick:os},null,8,["class","label"])):i("",!0),t(q)&&!t(p)?(l(),r(a,{key:1,class:m({"tw-w-full":!s.isButtonsSmall}),label:t(c)("bonus_make_spins"),onClick:ss},null,8,["class","label"])):i("",!0),s.showBonusInfo?(l(),r(a,{key:2,class:m({"tw-w-full tw-mt-2":!s.isButtonsSmall}),label:t(c)("bonus_info"),"color-type":"outline",onClick:o[0]||(o[0]=_=>es(e.bonus.id))},null,8,["class","label"])):i("",!0),t(z)?(l(),r(a,{key:3,class:m({"tw-w-full tw-mt-2":!s.isButtonsSmall}),label:t(c)("bonus_close"),"color-type":"secondary",onClick:o[1]||(o[1]=_=>w.value=!0)},null,8,["class","label"])):i("",!0),t(G)?(l(),r(a,{key:4,class:m({"tw-w-full":!s.isButtonsSmall}),label:t(c)("bonus_activate"),onClick:K},null,8,["class","label"])):i("",!0),t(J)?(l(),r(a,{key:5,class:m({"tw-w-full":!s.isButtonsSmall}),label:t(c)("bonus_registration"),onClick:ts},null,8,["class","label"])):i("",!0),t(S)||t(B)?(l(),T("span",gs,ps(t(S)||t(c)(t(B))),1)):i("",!0),t(w)?(l(),r(d,{key:7,"sub-title":"are_you_sure",title:"bonus_close",onClose:M,onConfirm:Y})):i("",!0)],64)}}});export{Is as _};
