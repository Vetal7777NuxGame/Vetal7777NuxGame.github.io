import{U as Y,V as ee,i as h,j as V,aH as y,o as l,c as m,a as e,W as t,u as k,t as i,b as d,K as P,x as I,aj as ge,aI as ve,ah as fe,ai as we,a5 as se,a6 as be,_ as ye,$ as he,ak as ke,aJ as $e,aK as Be,Z as Me,a0 as X,aL as b,l as Te,f as g,a8 as A,a9 as Ee,aM as Ne,aN as Se,n as Ce,aO as Ae,aP as Ie,a4 as Le}from"./GLBH15dL.js";import{_ as te}from"./iGJpO4hG.js";import{g as De}from"./C1D4Ozuk.js";import{_ as Oe}from"./DkGIR1NE.js";import{_ as Ue}from"./DRArWz0C.js";import{u as Re}from"./ez3e82Nz.js";import{u as Pe}from"./DCMfTZpQ.js";import{u as Ve}from"./D2Aygtl8.js";import{u as je}from"./90IrVaMF.js";import"./C7PoV1zm.js";import"./D8aEg3BZ.js";const j=v=>(fe("data-v-d5000348"),v=v(),we(),v),xe={class:"message-order"},He=["src"],ze=["innerHTML"],Ke=j(()=>e("div",{class:"tw-my-6 ng-divider"},null,-1)),We={key:0,class:"tw-flex tw-flex-col tw-items-center tw-my-6"},Fe=["href"],Ge={class:"tw-mt-6 tw-mb-2"},Je=j(()=>e("div",{class:"tw-my-6 ng-divider"},null,-1)),Qe={key:1,class:"tw-my-6"},Ze={class:"message-order-subtitle"},qe={class:"message-order-info"},Xe={class:"tw-flex tw-items-center tw-gap-3"},Ye=["src"],es={class:"tw-text-base"},ss={class:"tw-flex tw-items-center"},ts={class:"tw-text-base"},as=["src"],os={key:2,class:"tw-flex"},ns={class:"tw-w-1/2 tw-pe-6"},is={class:"message-order-subtitle"},rs={class:"tw-mt-4 tw-text-base"},ls={class:"tw-w-1/2 tw-ps-6 tw-border-l tw-border-border-primary"},cs={class:"message-order-subtitle"},ds={class:"tw-mt-4 tw-text-base"},ms={class:"mt-8"},_s=j(()=>e("div",{class:"tw-my-6 ng-divider"},null,-1)),us={class:"message-order-footer"},ps=Y({__name:"OrderMessage",props:{item:{},checked:{type:Boolean}},setup(v){const _=v,L=ee(),u=h(!1),$=V(()=>{var s;return _.item.type===y.tier_push||_.item.type===y.tier_modal?"/img/tierNotyBanner.png":((s=_.item.message)==null?void 0:s.banner)||_.item.message_default.banner||"/img/tierNotyBanner.png"}),B=s=>{ge(s),u.value=!u.value,setTimeout(()=>{u.value=!u.value},1e3)};return(s,M)=>{var T,f,E,w,p,N;const D=te,O=ve;return l(),m("div",xe,[e("img",{src:t($),alt:"banner",class:"message-order-img"},null,8,He),e("div",{class:"message-order-desc",innerHTML:((f=(T=s.item)==null?void 0:T.message)==null?void 0:f.description)||s.item.message_default.description},null,8,ze),Ke,s.item.message.btn_link&&s.item.message.btn?(l(),m("div",We,[e("a",{target:"_BLANK",href:s.item.message.btn_link},[k(D,{class:"tw-w-full","label-key":s.item.message.btn},null,8,["label-key"])],8,Fe),e("span",Ge,i(s.$t("or_copy_the_link_below"))+":",1),e("span",{class:"tw-text-text-brand",onClick:M[0]||(M[0]=x=>B(s.item.message.btn_link))},i(t(u)?s.$t("copied"):s.item.message.btn_link),1),Je])):d("",!0),(E=s.item.message)!=null&&E.relation_data?(l(),m("div",Qe,[e("div",Ze,i(s.$t("order_details")),1),e("div",qe,[e("div",Xe,[(w=s.item.message.relation_data)!=null&&w.product_banner?(l(),m("img",{key:0,src:s.item.message.relation_data.product_banner,class:"tw-w-[50px] tw-h-[50px] tw-object-contain tw-rounded",alt:"banner"},null,8,Ye)):d("",!0),e("div",es,i(s.item.message.relation_data.product_name),1)]),e("div",ss,[e("span",ts,i(s.item.message.relation_data.product_points),1),e("img",{src:t(De)("nuxPoint"),class:"tw-w-4 tw-h-4 tw-ms-2",alt:"currency"},null,8,as)])])])):d("",!0),(N=(p=s.item.message)==null?void 0:p.relation_data)!=null&&N.address?(l(),m("div",os,[e("div",ns,[e("div",is,i(s.$t("customer_information")),1),e("div",rs,[e("p",null,i(s.item.message.relation_data.user_name),1),e("p",null,i(s.item.message.relation_data.user_phone),1)])]),e("div",ls,[e("div",cs,i(s.$t("delivery_adress")),1),e("div",ds,[e("p",null,i(s.item.message.relation_data.address.full_name),1),e("p",null,i(s.item.message.relation_data.address.street),1),e("p",null,i(s.item.message.relation_data.address.city)+", "+i(s.item.message.relation_data.address.zip_code),1),e("p",ms,i(s.item.message.relation_data.address.country),1)])])])):d("",!0),_s,e("div",us,[e("p",null,[P(i(s.$t("footer_messsage_part_1"))+" ",1),k(O,{class:"footer-link",to:t(L)({path:"/tickets/create"})},{default:I(()=>[P(i(s.$t("support")),1)]),_:1},8,["to"]),P(" "+i(s.$t("footer_messsage_part_2")),1)])])])}}}),gs=se(ps,[["__scopeId","data-v-d5000348"]]),vs={class:"message-date"},fs={class:"tw-flex tw-items-center tw-justify-between tw-mb-6"},ws={class:"message-title"},bs={class:"message-actions"},ys={class:"message-body"},hs={key:1},ks=["src"],$s={class:"tw-my-6 tw-flex tw-flex-col tw-gap-2"},Bs={key:0,class:"tw-text-3xl tw-font-bold"},Ms=["innerHTML"],Ts={key:2,class:"tw-flex tw-items-center tw-justify-center"},Es={key:1,class:"tw-flex tw-flex-col tw-items-center tw-gap-8"},Ns={class:"messageBonusTitle"},Ss=Y({__name:"[id]",setup(v){const _=be(),L=ye(),u=he(),$=ee(),B=ke(),s=$e(),M=Be(),{fetchMessage:D,setUnread:O,deleteMessages:T,setIsUnreadUserMessages:f,activateMessageBonus:E}=M,{t:w}=Me(),{$emitter:p}=Ee(),{openModal:N}=s,{showActivateModal:x}=B,{setBreadcrumbs:ae}=Re(),{getBonusTypes:oe,isMultiBalance:ne,isMobile:ie}=X(u),{getActiveBonus:re}=X(B),H={[b.UNREAD]:O,[b.DELETE]:T},U=h(!1),S=h(!1),R=h(_.params.id),a=h({}),le=V(()=>{var r,o;return a.value.type===y.tier_push||a.value.type===y.tier_modal?"/img/tierNotyBanner.png":((o=(r=a.value)==null?void 0:r.message)==null?void 0:o.banner)||a.value.message_default.banner||"/img/tierNotyBanner.png"}),z=V(()=>{var r,o,c;return((o=(r=a.value)==null?void 0:r.message)==null?void 0:o.subject)||((c=a==null?void 0:a.value.message_default)==null?void 0:c.subject)}),ce=()=>{var o,c,n;if(!((o=a.value)!=null&&o.bonus))return;ne.value||((c=a.value)==null?void 0:c.bonus.actions.includes(Ae.PROMO_CODE))||re.value?(me(),x((n=a.value)==null?void 0:n.bonus,Ie.MESSAGES)):de()},de=async()=>{var r,o;try{if(!((r=a.value)!=null&&r.bonus))throw new Error("No bonus");await E({id:(o=a.value)==null?void 0:o.bonus.id}),W()}catch(c){console.log("activateBonus MessagesAction",c)}},K=async r=>{if(r===b.DELETE){const c=await H[r]([+R.value]);f(c.unread_company_messages),S.value=!1,L.push($({path:"/messages"}));return}r===b.UNREAD&&(a.value.is_read=!1);const o=await H[r]([+R.value]);f(o.unread_company_messages)},W=async()=>{try{await F()}catch(r){console.log("confirmBonus /messages/id",r)}},F=async()=>{var r,o,c;try{U.value=!0;const n=await D(_.params.id);a.value=n,(r=n==null?void 0:n.message)!=null&&r.description?a.value.message.description=decodeURIComponent(escape(atob((o=n==null?void 0:n.message)==null?void 0:o.description))):a.value.message_default.description=decodeURIComponent(escape(atob((c=n==null?void 0:n.message_default)==null?void 0:c.description))),f(n.unread_company_messages)}catch(n){console.log(n)}finally{U.value=!1}},me=()=>{p.on(A.BONUS_ACTIVATED,W),p.on(A.CLOSE_BONUS_MODAL,G)},G=()=>{p.off(A.BONUS_ACTIVATED),p.off(A.CLOSE_BONUS_MODAL)};return ae([{label:w("messages"),path:$({path:"/messages"})},{label:`â„– ${R.value}`}]),Ve(async()=>{await F()},"$pL48QLkPtc"),je(),Te(()=>{G()}),Pe({title:()=>z.value||"Messages"}),(r,o)=>{const c=Le,n=te,_e=gs,ue=Oe,pe=Ue;return l(),g(pe,{loading:t(U)},{default:I(()=>{var J,Q,Z,q;return[t(a)?(l(),m("div",{key:0,class:Ce(["message",{"message--mobile":t(ie)}])},[e("div",vs,i(t(Ne)(t(a).date)),1),e("div",fs,[e("h1",ws,i(t(z)),1),e("div",bs,[t(a).is_read?(l(),g(n,{key:0,"is-with-icon":"",class:"message-action","color-type":"transparent","icon-position":"right","label-key":"unread",onClick:o[0]||(o[0]=C=>K(t(b).UNREAD))},{default:I(()=>[k(c,{name:"message_unread",size:25})]),_:1})):d("",!0),k(n,{"is-with-icon":"",class:"message-action","color-type":"transparent","icon-position":"right","label-key":"delete",onClick:o[1]||(o[1]=C=>S.value=!0)},{default:I(()=>[k(c,{name:"delete",size:25})]),_:1})])]),e("div",ys,[t(a).type===t(y).order_messages?(l(),g(_e,{key:0,item:t(a)},null,8,["item"])):(l(),m("div",hs,[e("div",null,[e("img",{src:t(le),alt:"banner",class:"message-img"},null,8,ks)]),e("div",$s,[t(a).bonus?(l(),m("div",Bs,i(t(a).bonus.name),1)):d("",!0),e("div",{innerHTML:((Q=(J=t(a))==null?void 0:J.message)==null?void 0:Q.description)||((q=(Z=t(a))==null?void 0:Z.message_default)==null?void 0:q.description)},null,8,Ms)]),t(a).type===t(y).agent_player_after_registration_modal?(l(),g(n,{key:0,"label-key":"go_to_profile",onClick:o[2]||(o[2]=C=>t(N)(t(Se).PROFILE_STATISTIC))})):d("",!0)])),t(a).bonus?(l(),m("div",Ts,[t(a).bonus.is_activated?(l(),g(n,{key:0,"label-key":"bonus_has_been_activated","is-disabled":!0})):(l(),m("div",Es,[e("span",Ns,i(t(w)("you_have_got_bonus"))+" "+i(t(w)(`${t(oe)[t(a).bonus.type]}_bonus`)),1),t(a).bonus.not_for_activation?d("",!0):(l(),g(n,{key:0,"label-key":"activate",onClick:ce}))]))])):d("",!0)])],2)):d("",!0),t(S)?(l(),g(ue,{key:1,onConfirm:o[3]||(o[3]=C=>K(t(b).DELETE)),onClose:o[4]||(o[4]=C=>S.value=!1)})):d("",!0)]}),_:1},8,["loading"])}}}),xs=se(Ss,[["__scopeId","data-v-e85ee276"]]);export{xs as default};
