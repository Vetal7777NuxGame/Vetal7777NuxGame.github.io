import{U as Q,V as fe,$ as Y,a0 as Z,i as d,j as O,aH as G,p as X,o as y,c as S,u as o,W as s,a3 as ee,ag as j,a as i,t as b,aM as J,x as k,n as F,aI as ye,a5 as se,Z as ve,aK as he,M as ke,aQ as be,K as Ce,f as V,b as I,a2 as we,a4 as Ne}from"./GLBH15dL.js";import{M as $e,C as z,_ as Me}from"./CPHuSmoe.js";import{_ as te}from"./CNKCMX-k.js";import{_ as Te}from"./iGJpO4hG.js";import{_ as xe}from"./CpKgH15o.js";import{_ as Ve}from"./gfcTzQ0I.js";import{_ as Ie}from"./Dh0Rj5Pr.js";import{_ as Se}from"./DRArWz0C.js";import{_ as De}from"./DkGIR1NE.js";import{u as Le}from"./DCMfTZpQ.js";import{u as Be}from"./D2Aygtl8.js";import{u as Ee}from"./90IrVaMF.js";import"./DjhTuyUU.js";import"./sAv92ZWP.js";import"./BOAzHGzj.js";import"./D8aEg3BZ.js";import"./DoW1pMUu.js";import"./Cy95Qd2y.js";import"./D4Tfbifg.js";import"./C7PoV1zm.js";const Ae={class:"message-date--mobile"},Pe=["src"],Re={class:"message-text"},Ue={class:"tw-flex tw-items-center tw-justify-between tw-w-full"},ze={class:"message-title"},Oe={class:"message-date"},je={class:"message-desc"},Fe=Q({__name:"MessageItem",props:{item:{},checked:{type:Boolean}},emits:["select"],setup(H,{emit:C}){const m=H,r=C,D=fe(),w=Y(),{isMobile:L}=Z(w),v=d(!1),B=O(()=>{var n;return m.item.type===G.tier_push||m.item.type===G.tier_modal?"/img/tierNotyBanner.png":((n=m.item.message)==null?void 0:n.banner)||m.item.message_default.banner||"/img/tierNotyBanner.png"}),E=O(()=>({"message--checked":v.value,"message--mobile":L.value,"message--unread":!m.item.is_read}));return X(()=>m.checked,n=>{v.value=n}),(n,g)=>{const A=te,N=ye;return y(),S("div",{class:F(["message",s(E)])},[o(A,{modelValue:s(v),"onUpdate:modelValue":g[0]||(g[0]=_=>ee(v)?v.value=_:null),type:s(j).check,class:"message-checkbox",onChange:g[1]||(g[1]=_=>r("select",n.item.id))},null,8,["modelValue","type"]),i("span",Ae,b(s(J)(n.item.date)),1),i("img",{src:s(B),alt:"banner",class:"message-img"},null,8,Pe),i("div",Re,[o(N,{to:s(D)({path:`/messages/${n.item.id}`})},{default:k(()=>{var _,c,l,u;return[i("div",Ue,[i("h2",ze,b(((c=(_=n.item)==null?void 0:_.message)==null?void 0:c.subject)||n.item.message_default.subject),1),i("span",Oe,b(s(J)(n.item.date)),1)]),i("p",je,b(((u=(l=n.item)==null?void 0:l.message)==null?void 0:u.description)||n.item.message_default.description),1)]}),_:1},8,["to"])])],2)}}}),He=se(Fe,[["__scopeId","data-v-66db5bdd"]]),Ke={class:"ng-messages-caption ng-flex-center"},qe={class:"messages-wrapper"},We={class:"messages-actions"},Ge={key:1,class:"tw-flex tw-items-center tw-justify-between"},Je={class:"tw-text-center"},Qe={key:1,class:"messages-list"},Ye=Q({__name:"index",async setup(H){let C,m;const{t:r}=ve(),D={type:$e.ACCORDION,style:{accordionContainerClass:"filter-accordion"}},w=[{key:0,label:r("all")},{key:1,label:r("read")},{key:2,label:r("unread")}],L=he(),{fetchMessages:v,setRead:B,setUnread:E,deleteMessages:n,setIsUnreadUserMessages:g}=L,A=Y(),{isLessContainerDesktop:N}=Z(A),_={read:B,unread:E,delete:n},c=d({page:1,type:0,from:"",to:"",search:"",theme:"dark",limit:10}),l=d([]),u=d(null),f=d(!1),a=d([]),$=d(!1),K=d([]),M=d(!1),ae=O(()=>{var e,t;return((e=a.value)==null?void 0:e.length)===((t=l.value)==null?void 0:t.length)?j.check:j.indeterminate});X(()=>a.value,()=>{var e;f.value=!1,((e=a.value)==null?void 0:e.length)>0&&(f.value=!0)});const ne=()=>{f.value?a.value=l.value.map(e=>e.id):a.value=[]},oe=e=>{a.value.includes(e)?a.value=a.value.filter(t=>t!==e):a.value=[...a.value,e],a.value.length+1<(c.value.limit??0)&&(f.value=!1),a.value.length+1===c.value.limit&&(f.value=!0)},le=e=>{c.value.page=e.page,T()},ie=()=>{K.value=[{target:"search",componentName:z.SEARCH_INPUT,props:{placeholderText:r("search_dots"),modelValue:"",isRequired:!0}},{target:"date",componentName:z.DATE_PICKER,props:{modelValue:"",modelType:"yyyy-MM-dd",format:"yyyy-MM-dd",isDisabled:!1,labelText:r("date"),range:!0,inputName:"date",multiCalendar:!0},mobile:{redirect:!0}},{target:"type",componentName:z.SINGLE_SELECTOR,props:{modelValue:"",additionalLabel:r("type"),displayedOption:"label",returnedOption:"key",defaultOption:w[0],itemList:w,isAllowEmpty:!1},mobile:{redirect:!0}}]},re=e=>{var p;const t=((p=e==null?void 0:e.date)==null?void 0:p.length)>0;c.value={...c.value,from:t?e.date[0]:"",to:t?e.date[1]:"",search:e.search,type:Number(e.type)||0,page:1},T()},P=async e=>{if(e==="delete"){l.value=l.value.filter(R=>!a.value.includes(R.id));const p=await _[e](a.value);g(p.unread_company_messages),M.value=!1;return}const t=await _[e](a.value);g(t.unread_company_messages),a.value=[],T()},T=async()=>{try{$.value=!0;const e=await v(we(c.value));l.value=e.messages,u.value=e.pagination,g(e.unread_company_messages)}catch(e){console.error("getData messages -> index",e)}finally{$.value=!1}};return ke(()=>ie()),[C,m]=be(async()=>Be(async()=>{await T()},"$ogd0YzJqUM")),await C,m(),Ee(),Le({title:"Messages"}),(e,t)=>{const p=Ne,R=Me,ce=te,U=Te,me=xe,ue=He,pe=Ve,de=Ie,ge=Se,_e=De;return y(),S("div",{class:F(["messages",{"messages--mobile":s(N)}])},[i("h1",Ke,[o(p,{name:"message_unread",size:24}),Ce(" "+b(s(r)("messages")),1)]),o(R,{"mobile-settings":D,list:s(K),class:F(["filter-list",{"filter-list--mobile":s(N)}]),onChange:re},null,8,["list","class"]),o(ge,{loading:s($)},{default:k(()=>{var x,q,W;return[i("div",qe,[i("div",We,[(x=s(l))!=null&&x.length?(y(),V(ce,{key:0,modelValue:s(f),"onUpdate:modelValue":t[0]||(t[0]=h=>ee(f)?f.value=h:null),type:s(ae),onChange:ne},null,8,["modelValue","type"])):I("",!0),(q=s(a))!=null&&q.length?(y(),S("div",Ge,[o(U,{"is-with-icon":"",class:"messages-action","color-type":"transparent","icon-position":"right","label-key":"read",onClick:t[1]||(t[1]=h=>P("read"))},{default:k(()=>[o(p,{name:"message_read",size:20})]),_:1}),o(U,{"is-with-icon":"",class:"messages-action","color-type":"transparent","icon-position":"right","label-key":"unread",onClick:t[2]||(t[2]=h=>P("unread"))},{default:k(()=>[o(p,{name:"message_unread",size:20})]),_:1}),o(U,{"is-with-icon":"",class:"messages-action","color-type":"transparent","icon-position":"right","label-key":"delete",onClick:t[3]||(t[3]=h=>M.value=!0)},{default:k(()=>[o(p,{name:"delete",size:20})]),_:1})])):I("",!0)]),!((W=s(l))!=null&&W.length)&&!s($)?(y(),V(me,{key:0},{content:k(()=>[i("div",Je,b(s(r)("no_result")),1)]),_:1})):(y(),S("div",Qe,[o(pe,{list:s(l),container:!1,"key-name":"messages-list"},{item:k(({item:h})=>[o(ue,{item:h,checked:s(a).includes(h.id),onSelect:oe},null,8,["item","checked"])]),_:1},8,["list"]),s(u)&&s(u).total_pages>1?(y(),V(de,{key:0,"current-page":s(c).page,pages:s(u).total_pages,"per-page":s(u).per_page,total:s(u).total,class:"tw-py-4",onChange:le},null,8,["current-page","pages","per-page","total"])):I("",!0)]))])]}),_:1},8,["loading"]),s(M)?(y(),V(_e,{key:0,onConfirm:t[4]||(t[4]=x=>P("delete")),onClose:t[5]||(t[5]=x=>M.value=!1)})):I("",!0)],2)}}}),vs=se(Ye,[["__scopeId","data-v-c21c896b"]]);export{vs as default};
