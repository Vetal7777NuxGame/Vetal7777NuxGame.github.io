import{U as W,Z as Et,ap as Lt,V as At,a6 as yt,_ as ht,ab as Nt,a7 as It,a0 as wt,i as Bt,j as r,aq as m,ar as e,as as Tt,o as u,c as f,W as l,f as $,x as V,u as h,b as p,a,t as o,K as y,at as $t,Y as K,a4 as q,aa as Vt,a5 as Pt,n as C,d as S}from"./GLBH15dL.js";import{p as Yt,_ as gt}from"./Bwa_AFDR.js";import{_ as kt}from"./DOMz106x.js";import{_ as Ct}from"./iGJpO4hG.js";import{_ as Dt}from"./DpuOAysh.js";import{u as Gt}from"./C9aiABHZ.js";import{g as D}from"./C1D4Ozuk.js";const Kt={class:"tw-flex tw-items-center"},St={class:"tw-flex tw-flex-col tw-items-center"},zt={key:0},Ft={key:0},Mt={key:1,class:"tw-flex tw-items-center tw-mt-1"},Ot={key:0,class:"tw-flex tw-flex-col tw-items-center tw-p-4"},Ht={class:"tw-text-center tw-text-base"},Jt={key:0,class:"tw-text-center tw-text-base tw-mt-2"},Rt={class:"tw-flex tw-items-center tw-justify-center"},jt=["src","alt"],Wt={key:1,class:"desc"},qt=W({__name:"NgBattleButton",props:{battle:{}},emits:["update-list"],setup(w,{emit:E}){const{t:b}=Et(),{show:t}=Lt(),v=At(),{platformCommasFormat:P}=Gt(),L=yt(),A=ht(),Y=Nt(),B=It(),{setGameError:Z}=B,{defaultGameError:Q}=B,{getUserBattle:i,getUserId:N}=wt(Y),{PVP_LOBBY_LINK:g,PVP_BATTLES:k,PVP_BATTLE_ID:we}=$t,z=E,n=w,F=L.meta.metaName,_=Bt({title:"delete_battle",subTitle:"are_you_sure_want_to_delete",description:"this_actions_cannot_be_reversed",acceptText:"delete_pvp_battle",show:!1,type:"delete"}),M=(s="delete")=>{s==="leave"&&(_.value.title="leave_battle",_.value.acceptText="agree_and_leave"),_.value.type=s,_.value.show=!0},X=r(()=>L.meta.metaName===k),I=r(()=>L.meta.metaName===g),O=r(()=>{var s,d;return((s=i==null?void 0:i.value)==null?void 0:s.battle_id)&&((d=i==null?void 0:i.value)==null?void 0:d.battle_id)!==n.battle.id&&n.battle.battle_status===m.AVAILABLE_KEY}),U=r(()=>{var s;return((s=i==null?void 0:i.value)==null?void 0:s.battle_id)&&(N==null?void 0:N.value)===n.battle.player_id&&n.battle.battle_status===m.AVAILABLE_KEY}),x=r(()=>n.battle.battle_status===m.FINISHED_KEY),tt=r(()=>{var s;return!((s=i==null?void 0:i.value)!=null&&s.battle_id)&&n.battle.battle_status===m.AVAILABLE_KEY&&I.value}),et=r(()=>{var s;return((s=i==null?void 0:i.value)==null?void 0:s.battle_id)===n.battle.id&&(N==null?void 0:N.value)!==n.battle.player_id&&n.battle.battle_status===m.AVAILABLE_KEY&&I.value}),st=r(()=>n.battle.battle_status===m.PLAYING_KEY&&X.value),at=r(()=>n.battle.battle_status===m.PLAYING_KEY&&I.value&&n.battle.player_status&&n.battle.player_status===m.DELETED_KEY),lt=r(()=>n.battle.battle_status===m.PLAYING_KEY&&I.value&&n.battle.player_status&&n.battle.player_status!==m.PLAYING_KEY),nt=r(()=>n.battle.battle_status===m.PLAYING_KEY&&I.value&&n.battle.player_status===m.PLAYING_KEY),c=r(()=>O.value?e.UNAVAILABLE:U.value?e.AVAILABLE_DELETE:x.value?e.COMPLETED:tt.value?e.JOIN_BATTLE:et.value?e.LEAVE_BATTLE:st.value||at.value?e.PLAYING:lt.value?e.PLAYING_LEAVE:nt.value?e.FINISHED:Tt[n.battle.battle_status]),ot=r(()=>[e.UNAVAILABLE,e.COMPLETED,e.CANCELED].includes(c.value)?"dark":[e.PLAYING,e.FINISHED,e.LEAVE_BATTLE].includes(c.value)?"secondary":"primary"),H=r(()=>[e.AVAILABLE,e.UNAVAILABLE,e.AVAILABLE_DELETE,e.JOIN_BATTLE,e.LEAVE_BATTLE,e.PLAYING_LEAVE,e.PLAYING,e.FINISHED].includes(c.value)),J=r(()=>[g,k].includes(F)),it=r(()=>c.value===e.PLAYING_LEAVE&&J.value),rt=r(()=>c.value===e.AVAILABLE_DELETE&&J.value),G=r(()=>O.value?b("in_the_match"):null),ct=r(()=>[e.AVAILABLE,e.AVAILABLE_DELETE,e.JOIN_BATTLE,e.LEAVE_BATTLE].includes(c.value)?b("open"):[e.PLAYING,e.PLAYING_LEAVE].includes(c.value)?b("live"):c.value===e.FINISHED?b("results_in"):null),ut=async()=>{_.value.show=!1;try{_.value.type==="delete"?await mt():await R(),L.meta.metaName===k?z("update-list"):A.push(v(K.pvp_battle))}catch(s){console.error("confirmHandler NgBattleButton",s)}},_t=()=>{Z(Q)},dt=()=>{c.value===e.JOIN_BATTLE&&n.battle.hover&&n.battle.hover.show&&t({message:"Here must be text about battle.hover params",position:"bottom-right"}),c.value===e.PLAYING&&L.meta.metaName!==g&&A.push(v({name:"battles-lobby-id",params:{id:n.battle.link}})),c.value===e.PLAYING_LEAVE?A.push(v(`${K.pvp_battle}/${n.battle.id}`)):c.value===e.LEAVE_BATTLE?R():(c.value===e.JOIN_BATTLE||c.value===e.AVAILABLE&&F===g)&&pt()},mt=async()=>{var s;try{await B.deleteBattle({battleId:(s=i==null?void 0:i.value)==null?void 0:s.battle_id})}catch(d){console.error("onDelete NgBattleButton",d)}},R=async()=>{var s,d;try{await B.leaveBattle({battleId:Number((s=n==null?void 0:n.battle)==null?void 0:s.battle_id)||Number((d=i==null?void 0:i.value)==null?void 0:d.battle_id)}),Y.setUserBattle(null),L.meta.metaName===k?z("update-list"):A.push(v(K.pvp_battle))}catch(T){console.error("onLeave NgBattleButton",T)}},pt=async()=>{const{data:s}=await B.joinBattle({battleId:n.battle.battle_id});Y.setUserBattle(s),s.battle_id===2&&A.push(v({name:"battles-id",params:{id:s.battle_id}}))};return(s,d)=>{const T=q,j=Vt,bt=kt,ft=Ct,vt=Dt;return u(),f("div",Kt,[l(it)?(u(),$(j,{key:0,class:"leave-button tw-mr-1","color-type":"secondary",size:"large",onClick:d[0]||(d[0]=()=>M("leave"))},{default:V(()=>[h(T,{name:"leave",size:24})]),_:1})):p("",!0),h(ft,{class:"tw-w-full",link:l(v)({name:"battles-lobby-id",params:{id:n.battle.link}}),"is-link":!l(I),"color-type":l(ot),size:"large",onClick:dt},{default:V(()=>[a("span",St,[a("span",null,o(l(b)(l(c))),1),l(H)||l(G)?(u(),f("span",zt,[l(G)?(u(),f("span",Ft,o(l(G)),1)):p("",!0),l(H)?(u(),f("span",Mt,[[l(e).PLAYING,l(e).PLAYING_LEAVE].includes(l(c))?(u(),$(T,{key:0,name:"stream_battle",size:12})):p("",!0),y(" "+o(l(ct))+"Â  ",1),h(bt,{id:`${s.battle.battle_id}-timer`,"hidden-days":!0,"hidden-hours":!0,"end-time":s.battle.timer*1e3,class:"tw-font-bold",onCountdownFinished:_t},null,8,["id","end-time"])])):p("",!0)])):p("",!0)])]),_:1},8,["link","is-link","color-type"]),l(rt)?(u(),$(j,{key:1,class:"delete-button tw-ml-1","color-type":"secondary",size:"large",onClick:M},{default:V(()=>[h(T,{name:"delete",size:24})]),_:1})):p("",!0),l(_).show?(u(),$(vt,{key:2,"sub-title":l(_).subTitle,description:l(_).description,title:l(_).title,"accept-text":l(_).acceptText,onClose:d[1]||(d[1]=Be=>l(_).show=!1),onConfirm:ut},{content:V(()=>[l(_).type==="leave"?(u(),f("div",Ot,[a("p",Ht,o(s.$t("are_you_sure_want_to_leave")),1),s.battle.entry_fee?(u(),f("div",Jt,[y(o(s.$t("your_entry_fee_will_not_be_refounded"))+" ",1),a("div",Rt,[a("span",null,o(l(P)(l(Yt),s.battle.entry_fee)),1),s.battle.battle_currency?(u(),f("img",{key:0,src:l(D)(s.battle.battle_currency),alt:s.battle.battle_currency,class:"tw-ms-1"},null,8,jt)):p("",!0)])])):(u(),f("div",Wt,o(s.$t("your_entry_fee_will_be_refounded")),1))])):p("",!0)]),_:1},8,["sub-title","description","title","accept-text"])):p("",!0)])}}}),Zt=Pt(qt,[["__scopeId","data-v-fba3806d"]]),Qt=w=>{const E=Math.floor(w/60),b=w-E*60;return`${E<10?"0"+E:E}:${b<10?"0"+b:b}`},Xt={class:"picture"},Ut=["src","alt"],xt={class:"content"},te={key:0,class:"item"},ee={class:"text center-gap"},se={class:"info center-gap"},ae={class:"item"},le={class:"text center-gap"},ne={class:"info center-gap"},oe=["src","alt"],ie={class:"item"},re={class:"text center-gap"},ce={class:"info center-gap"},ue=["src","alt"],_e={key:1,class:"item"},de={class:"text center-gap"},me={class:"info center-gap"},pe={class:"item"},be={class:"text center-gap"},fe={class:"info center-gap"},ve={class:"item"},Ee={class:"text center-gap"},Le={class:"info center-gap"},Ae={class:"item"},ye={class:"text center-gap tooltip"},he={class:"tooltip info"},Ne={class:"info center-gap"},Ie=["src","alt"],Ce=W({__name:"BattleItem",props:{classList:{default:""},item:{},isColumn:{type:Boolean,default:!1}},emits:["update-list"],setup(w,{emit:E}){const b=E;return(t,v)=>{const P=q,L=gt,A=Zt;return u(),f("div",{class:C(["ng-battle-item",t.isColumn?"tw-flex-col":"",t.classList])},[a("picture",Xt,[t.isColumn?p("",!0):(u(),$(P,{key:0,name:t.item.battle_type,folder:"pvp",class:"icon"},null,8,["name"])),a("img",{src:t.item.banner_vertical,alt:t.item.link,class:C(["image",t.isColumn?"image-col":""])},null,10,Ut)]),a("div",{class:C(["wrapper",t.isColumn?"tw-mt-4":""])},[a("div",xt,[S(t.$slots,"caption",{props:t.item}),S(t.$slots,"item",{props:t.item},()=>[t.isColumn?(u(),f("dl",te,[a("dt",ee,o(t.$t("type")),1),a("dd",se,[y(o(t.$t(t.item.battle_type))+" ",1),h(P,{name:t.item.battle_type,size:16,folder:"pvp"},null,8,["name"])])])):p("",!0),a("dl",ae,[a("dt",le,o(t.$t("entry_fee")),1),a("dd",ne,[y(o(t.item.entry_fee)+" ",1),a("img",{src:l(D)(t.item.battle_currency),alt:t.item.battle_currency},null,8,oe)])]),a("dl",ie,[a("dt",re,o(t.$t("stake_amount")),1),a("dd",ce,[y(o(t.item.stake_amount)+" ",1),a("img",{src:l(D)(t.item.battle_currency),alt:t.item.battle_currency},null,8,ue)])]),t.item.duration&&t.isColumn?(u(),f("dl",_e,[a("dt",de,o(t.$t("duration")),1),a("dd",me,o(l(Qt)(t.item.duration)),1)])):p("",!0),a("dl",pe,[a("dt",be,o(t.$t("spins_count")),1),a("dd",fe,o(t.item.spins_count),1)]),a("dl",ve,[a("dt",Ee,o(t.$t("players")),1),a("dd",Le,o(t.item.active_participant_count)+" / "+o(t.item.participant_count),1)]),a("dl",Ae,[a("dt",ye,[y(o(t.$t("prize"))+" ",1),h(L,null,{content:V(()=>[a("div",he,[a("div",null,o(t.$t("prize_tooltip")),1),a("div",null,o(t.$t("platform_fee"))+" "+o(t.item.company_fee)+"%",1)])]),_:1})]),a("dd",Ne,[y(o(t.item.prize)+" ",1),a("img",{src:l(D)(t.item.battle_currency),alt:t.item.battle_currency},null,8,Ie)])])])]),a("div",{class:C(["actions",t.isColumn?"tw-mt-4":"tw-mt-1.5"])},[S(t.$slots,"actions",{props:t.item},()=>[h(A,{battle:t.item,onUpdateList:v[0]||(v[0]=Y=>b("update-list"))},null,8,["battle"])])],2)],2)],2)}}});export{Ce as _};
